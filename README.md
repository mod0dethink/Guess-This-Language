# GuessThisLanguage

## 1. このプロジェクトは何か
GuessThisLanguage は、言語識別クイズを題材にした Web アプリです。
ユーザーはテキストまたは音声のヒントから言語を推測し、ソロ練習またはオンライン対戦でスコアを競います。

## 2. デモ動画

※ デプロイ環境がないため、実際の動作を確認できるデモンストレーション動画を用意しました。

### オンライン対戦モード
[オンライン対戦のデモ動画](demos/OnlineMode.mp4)

リアルタイムマッチング、WebSocket による対戦、レーティングシステムなどの動作を確認できます。

### オフライン練習モード
[オフライン練習のデモ動画](demos/SoloMode.mp4)

テキストモード、メジャー言語の動作を確認できます。

## 3. 開発の動機
海外の言語学習コミュニティで、

- 語学マニア同士で言語のマニアックな知識で競い合いたい
- 一人でも対戦でも楽しめる言語当てゲームがほしい

という声が多かったため、それを形にする目的で開発しました。

## 4. 主要機能

### 4.1 認証・ユーザー管理
- サインアップ / ログイン（JWT ベース認証）
- プロフィール表示・編集
- ランキング表示

### 4.2 ゲームモード
- ソロモード
  - オフライン練習向け
  - 指定ラウンド数で連続出題
- マルチプレイヤーモード
  - WebSocket によるリアルタイム対戦
  - マッチング、対戦、結果表示までを一連で提供

### 4.3 出題タイプ
- Text モード
  - 文章から言語を推測
- Audio モード
  - 音声から言語を推測

### 4.4 難易度
- Major（主要言語）
- Rare（希少言語・スクリプト）

### 4.5 対戦進行
- ラウンド制で問題を出題
- 回答送信・正誤判定
- スコア集計
- 勝敗決定

### 4.6 レーティング
- 対戦相手との差に応じたレーティング更新（ELO ベース）


## 5. 想定ユーザー
- 言語学習者
- 言語コミュニティ参加者
- クイズ形式で語学に触れたいユーザー

## 6. アーキテクチャ・設計

### 6.1 フロントエンド
**技術スタック**
- React 18 + TypeScript
- Vite（ビルドツール）
- Tailwind CSS（スタイリング）

**ディレクトリ構成**
```
client/src/
├── api/          # APIクライアント（fetch wrapper、エンドポイント定義）
├── components/   # 共通コンポーネント（Header, Sidebar, ProgressBar等）
├── constants/    # 定数（言語リスト、ゲーム設定、フォールバック問題）
├── hooks/        # カスタムフック（useQuestions, useCountdown, useAudioPlayer等）
├── layouts/      # レイアウトコンポーネント
├── lib/          # ユーティリティ関数（認証、プロフィール管理、進捗計算等）
├── pages/        # ページコンポーネント（auth, practice, match, results等）
└── types/        # 型定義（models.ts, api.ts）
```

**設計の特徴**
- カスタムフックによる状態管理とロジックの分離
- API層の抽象化（`apiFetch`によるエラーハンドリング統一）
- コンポーネントの責務分離（Presentation / Container パターン）

### 6.2 バックエンド
**技術スタック**
- Go 1.21+
- Gin（Web フレームワーク）
- GORM（ORM）
- WebSocket（リアルタイム通信）
- JWT（認証）

**レイヤー構造**
```
server/
├── handlers/         # HTTPハンドラー、WebSocketハンドラー
│   └── websocket/    # 対戦ロジック、マッチング、レーティング計算
├── services/         # ビジネスロジック層
├── repositories/     # データアクセス層（GORM操作）
├── models/           # データモデル（User, Question, AudioQuestion等）
├── db/               # スキーマ、マイグレーション（gitignore対象）
└── router/           # ルーティング定義
```

**設計の特徴**
- 責務分離（Handler → Service → Repository）
- WebSocketによるステートフルな対戦管理
- Eloレーティングシステムによる公平なマッチング
- Edge TTS による音声問題の事前生成
- JWT認証によるステートレスな認証

**データフロー例（オンライン対戦）**
1. クライアント：WebSocket接続 + `join`メッセージ送信
2. サーバー：マッチング処理、ルーム作成
3. サーバー：問題生成 → 両プレイヤーに配信
4. クライアント：回答送信
5. サーバー：正誤判定、スコア集計
6. サーバー：次ラウンドまたは結果送信
7. サーバー：レーティング更新（Elo計算）
